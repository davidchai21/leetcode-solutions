This question can be solved using O(n^2) recording. 

Runtime: 1329ms
